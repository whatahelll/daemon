{
  "_comment": "Terraria Vanilla Server - Baseado no Egg Oficial",
  "meta": {
    "version": "PTDL_v2",
    "update_url": null
  },
  "exported_at": "2025-01-09T00:00:00+00:00",
  "uuid": "terraria",
  "name": "Terraria Vanilla",
  "author": "support@pyro.host",
  "description": "Dig, fight, explore, build! Nothing is impossible in this action-packed adventure game.",
  "features": null,
  "docker_images": {
    "Debian": "ghcr.io/parkervcp/yolks:debian"
  },
  "file_denylist": [],
  "startup": "./TerrariaServer.bin.x86_64 -config serverconfig.txt",
  "config": {
    "files": {
      "serverconfig.txt": {
        "parser": "properties",
        "find": {
          "worldpath": "/home/container/saves/Worlds",
          "worldname": "{{WORLD_NAME}}",
          "world": "/home/container/saves/Worlds/{{WORLD_NAME}}.wld",
          "difficulty": "{{WORLD_DIFFICULTY}}",
          "autocreate": "{{WORLD_SIZE}}",
          "port": "{{SERVER_PORT}}",
          "maxplayers": "{{MAX_PLAYERS}}",
          "motd": "{{SERVER_MOTD}}",
          "seed": "{{WORLD_SEED}}",
          "password": "{{PASSWORD}}",
          "npcstream": "{{NPCSTREAM}}"
        }
      }
    },
    "startup": {
      "done": "Type 'help' for a list of commands"
    },
    "logs": {},
    "stop": "exit"
  },
  "scripts": {
    "installation": {
      "script": "#!/bin/bash\n# Terraria Vanilla Installation Script\n#\n# Server Files: /mnt/server\n\necho \"üì¶ Installing Terraria server...\"\n\n## Install packages\napt update\napt install -y curl wget file unzip jq\n\nDOWNLOAD_LINK=invalid\n\nmkdir -p /mnt/server/\ncd /mnt/server/\n\necho \"üîç Determining Terraria version to download...\"\n\nif [ \"${TERRARIA_VERSION}\" == \"latest\" ] || [ \"${TERRARIA_VERSION}\" == \"\" ] ; then\n    echo \"üì• Getting latest Terraria version...\"\n    V=$(curl -sSL https://terraria.org/api/get/dedicated-servers-names | jq -r .[] | head -1)\n    DOWNLOAD_LINK=\"https://terraria.org/api/download/pc-dedicated-server/${V}\"\n    echo \"üìã Latest version: ${V}\"\nelse\n    echo \"üì• Getting specific Terraria version: ${TERRARIA_VERSION}\"\n    CLEAN_VERSION=$(echo ${TERRARIA_VERSION} | sed 's/\\.//g')\n    DOWNLOAD_LINK=$(curl -sSL https://terraria.wiki.gg/wiki/Server#Downloads | grep '>Terraria Server ' | grep -Eoi '<a [^>]+>' | grep -Eo 'href=\"[^\"]+\"' | grep -Eo '(http|https)://[^\"]+' | grep \"${CLEAN_VERSION}\" | cut -d'?' -f1)\nfi \n\necho \"üîó Download link: ${DOWNLOAD_LINK}\"\n\n## Validate download URL\nif [ ! -z \"${DOWNLOAD_LINK}\" ]; then \n    if curl --output /dev/null --silent --head --fail ${DOWNLOAD_LINK}; then\n        echo \"‚úÖ Download link is valid\"\n    else        \n        echo \"‚ùå Download link is invalid, exiting\"\n        exit 2\n    fi\nelse\n    echo \"‚ùå Could not determine download link\"\n    exit 2\nfi\n\nCLEAN_VERSION=$(echo ${DOWNLOAD_LINK##*/} | cut -d'-' -f3 | cut -d'.' -f1)\n\necho \"üì• Downloading Terraria server files...\"\ncurl -sSL ${DOWNLOAD_LINK} -o ${DOWNLOAD_LINK##*/}\n\nif [ ! -f \"${DOWNLOAD_LINK##*/}\" ]; then\n    echo \"‚ùå Download failed\"\n    exit 1\nfi\n\necho \"üì¶ Extracting server files...\"\nunzip ${DOWNLOAD_LINK##*/}\n\necho \"üìÅ Moving files to correct location...\"\ncp -R ${CLEAN_VERSION}/Linux/* ./\nchmod +x TerrariaServer.bin.x86_64\n\necho \"üßπ Cleaning up temporary files...\"\nrm -rf ${CLEAN_VERSION} ${DOWNLOAD_LINK##*/}\n\necho \"‚öôÔ∏è Generating default server configuration...\"\ncat <<EOF > serverconfig.txt\nworldpath=/home/container/saves/Worlds\nworldname={{WORLD_NAME}}\nworld=/home/container/saves/Worlds/{{WORLD_NAME}}.wld\ndifficulty={{WORLD_DIFFICULTY}}\nautocreate={{WORLD_SIZE}}\nport={{SERVER_PORT}}\nmaxplayers={{MAX_PLAYERS}}\nmotd={{SERVER_MOTD}}\nseed={{WORLD_SEED}}\npassword={{PASSWORD}}\nnpcstream={{NPCSTREAM}}\nEOF\n\necho \"üìÅ Creating worlds directory...\"\nmkdir -p /mnt/server/saves/Worlds\n\necho \"‚úÖ Terraria server installation completed!\"\necho \"üéÆ Server ready to start on port {{SERVER_PORT}}\"\necho \"üë• Max players: {{MAX_PLAYERS}}\"\necho \"üåç World: {{WORLD_NAME}} (Size: {{WORLD_SIZE}}, Difficulty: {{WORLD_DIFFICULTY}})\"\n\nif [ -f \"TerrariaServer.bin.x86_64\" ]; then\n    echo \"‚úÖ Server executable found and ready\"\nelse\n    echo \"‚ùå Warning: Server executable not found!\"\n    ls -la\nfi",
      "container": "ghcr.io/parkervcp/installers:debian",
      "entrypoint": "bash"
    }
  },
  "variables": [
    {
      "name": "Terraria Version",
      "description": "The version of Terraria server to install. Use 'latest' for the newest version or specify version like '1.4.4.9'",
      "env_variable": "TERRARIA_VERSION",
      "default_value": "latest",
      "user_viewable": true,
      "user_editable": true,
      "rules": "required|string|max:20",
      "field_type": "text"
    },
    {
      "name": "Server Port",
      "description": "The port to bind the server to.",
      "env_variable": "SERVER_PORT",
      "default_value": "7777",
      "user_viewable": true,
      "user_editable": false,
      "rules": "required|numeric|min:1024|max:65535",
      "field_type": "text"
    },
    {
      "name": "World Name",
      "description": "The name for the world file.",
      "env_variable": "WORLD_NAME",
      "default_value": "PyroWorld",
      "user_viewable": true,
      "user_editable": true,
      "rules": "required|string|max:20",
      "field_type": "text"
    },
    {
      "name": "Max Players",
      "description": "The maximum number of players the server will hold.",
      "env_variable": "MAX_PLAYERS",
      "default_value": "8",
      "user_viewable": true,
      "user_editable": true,
      "rules": "required|numeric|min:1|max:255",
      "field_type": "text"
    },
    {
      "name": "World Size",
      "description": "Defines the world size. 1 = Small, 2 = Medium, 3 = Large",
      "env_variable": "WORLD_SIZE",
      "default_value": "2",
      "user_viewable": true,
      "user_editable": true,
      "rules": "required|numeric|in:1,2,3",
      "field_type": "text"
    },
    {
      "name": "World Difficulty",
      "description": "World Difficulty. 0 = Classic, 1 = Expert, 2 = Master, 3 = Journey",
      "env_variable": "WORLD_DIFFICULTY",
      "default_value": "0",
      "user_viewable": true,
      "user_editable": true,
      "rules": "required|numeric|in:0,1,2,3",
      "field_type": "text"
    },
    {
      "name": "Server MOTD",
      "description": "Message of the Day displayed to players",
      "env_variable": "SERVER_MOTD",
      "default_value": "Welcome to Pyro Terraria Server!",
      "user_viewable": true,
      "user_editable": true,
      "rules": "required|string|max:128",
      "field_type": "text"
    },
    {
      "name": "World Seed",
      "description": "The seed to use when creating the world. Leave empty for random.",
      "env_variable": "WORLD_SEED",
      "default_value": "",
      "user_viewable": true,
      "user_editable": true,
      "rules": "nullable|string|max:20",
      "field_type": "text"
    },
    {
      "name": "Server Password",
      "description": "Password required to join the server. Leave empty for no password.",
      "env_variable": "PASSWORD",
      "default_value": "",
      "user_viewable": true,
      "user_editable": true,
      "rules": "nullable|string|max:20",
      "field_type": "text"
    },
    {
      "name": "NPC Stream",
      "description": "Reduces enemy skipping but increases bandwidth usage. Lower numbers = less skipping, more data. 0 = off.",
      "env_variable": "NPCSTREAM",
      "default_value": "0",
      "user_viewable": true,
      "user_editable": true,
      "rules": "required|int|between:0,60",
      "field_type": "text"
    }
  ]
}
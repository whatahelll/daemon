{
  "_comment": "Terraria Vanilla Server - Otimizado para Ubuntu",
  "meta": {
    "version": "PTDL_v2",
    "update_url": null
  },
  "exported_at": "2025-01-09T00:00:00+00:00",
  "uuid": "terraria",
  "name": "Terraria Vanilla",
  "author": "support@pyro.host",
  "description": "Dig, fight, explore, build! Nothing is impossible in this action-packed adventure game.",
  "features": null,
  "docker_images": {
    "Ubuntu": "ghcr.io/pterodactyl/yolks:debian"
  },
  "file_denylist": [],
  "startup": "./TerrariaServer.bin.x86_64 -config serverconfig.txt",
  "config": {
    "files": {
      "serverconfig.txt": {
        "parser": "properties",
        "find": {
          "worldpath": "/home/container/saves/Worlds",
          "worldname": "{{WORLD_NAME}}",
          "world": "/home/container/saves/Worlds/{{WORLD_NAME}}.wld",
          "difficulty": "{{WORLD_DIFFICULTY}}",
          "autocreate": "{{WORLD_SIZE}}",
          "port": "{{SERVER_PORT}}",
          "maxplayers": "{{MAX_PLAYERS}}",
          "motd": "{{SERVER_MOTD}}",
          "seed": "{{WORLD_SEED}}",
          "password": "{{PASSWORD}}"
        }
      }
    },
    "startup": {
      "done": "Type 'help' for a list of commands"
    },
    "logs": {},
    "stop": "exit"
  },
  "scripts": {
    "installation": {
      "script": "#!/bin/bash\n# Terraria Installation Script para Ubuntu\nset -e\n\necho \"üêß Instalando servidor Terraria no Ubuntu...\"\n\n# Atualizar reposit√≥rios e instalar depend√™ncias\necho \"üì¶ Instalando depend√™ncias...\"\nexport DEBIAN_FRONTEND=noninteractive\napt-get update -qq\napt-get install -y -qq curl wget unzip jq ca-certificates > /dev/null\n\ncd /mnt/server\n\necho \"üîç Determinando vers√£o do Terraria...\"\n\n# URLs conhecidas funcionais\nif [ \"${TERRARIA_VERSION}\" == \"latest\" ] || [ \"${TERRARIA_VERSION}\" == \"\" ] ; then\n    echo \"üì• Baixando Terraria vers√£o mais recente (1.4.4.9)...\"\n    DOWNLOAD_URL=\"https://terraria.org/api/download/pc-dedicated-server/terraria-server-1449.zip\"\n    VERSION_DIR=\"1449\"\nelse\n    echo \"üì• Baixando Terraria vers√£o: ${TERRARIA_VERSION}\"\n    CLEAN_VERSION=$(echo ${TERRARIA_VERSION} | sed 's/\\.//g')\n    DOWNLOAD_URL=\"https://terraria.org/api/download/pc-dedicated-server/terraria-server-${CLEAN_VERSION}.zip\"\n    VERSION_DIR=\"${CLEAN_VERSION}\"\nfi\n\necho \"üîó URL: ${DOWNLOAD_URL}\"\n\n# Download com retry\necho \"üì• Fazendo download do servidor...\"\nfor i in {1..3}; do\n    if wget -q --show-progress \"${DOWNLOAD_URL}\" -O terraria-server.zip; then\n        echo \"‚úÖ Download conclu√≠do\"\n        break\n    else\n        echo \"‚ùå Tentativa ${i}/3 falhou\"\n        if [ $i -eq 3 ]; then\n            echo \"‚ùå Todas as tentativas de download falharam\"\n            exit 1\n        fi\n        sleep 2\n    fi\ndone\n\n# Verificar se o arquivo foi baixado\nif [ ! -f \"terraria-server.zip\" ]; then\n    echo \"‚ùå Arquivo n√£o foi baixado\"\n    exit 1\nfi\n\necho \"üìÅ Arquivo baixado: $(ls -lh terraria-server.zip)\"\n\n# Extrair arquivo\necho \"üì¶ Extraindo servidor Terraria...\"\nunzip -q terraria-server.zip\n\n# Encontrar diret√≥rio extra√≠do\necho \"üîç Procurando diret√≥rio extra√≠do...\"\nEXTRACTED_DIR=$(find . -maxdepth 1 -type d -name \"*[0-9]*\" | head -1)\n\nif [ -z \"$EXTRACTED_DIR\" ]; then\n    echo \"‚ùå Diret√≥rio extra√≠do n√£o encontrado. Conte√∫do atual:\"\n    ls -la\n    exit 1\nfi\n\necho \"üìÇ Diret√≥rio encontrado: $EXTRACTED_DIR\"\necho \"üìã Conte√∫do do diret√≥rio:\"\nls -la \"$EXTRACTED_DIR\"\n\n# Verificar se existe pasta Linux\nif [ ! -d \"${EXTRACTED_DIR}/Linux\" ]; then\n    echo \"‚ùå Pasta Linux n√£o encontrada em ${EXTRACTED_DIR}\"\n    echo \"üìã Conte√∫do dispon√≠vel:\"\n    ls -la \"$EXTRACTED_DIR\"\n    exit 1\nfi\n\necho \"üìÇ Conte√∫do da pasta Linux:\"\nls -la \"${EXTRACTED_DIR}/Linux\"\n\n# Copiar arquivos Linux\necho \"üìÅ Copiando arquivos do servidor...\"\ncp -r \"${EXTRACTED_DIR}/Linux/\"* ./\n\n# Verificar se o execut√°vel foi copiado\nif [ ! -f \"TerrariaServer.bin.x86_64\" ]; then\n    echo \"‚ùå Execut√°vel TerrariaServer.bin.x86_64 n√£o encontrado ap√≥s c√≥pia\"\n    echo \"üìã Arquivos dispon√≠veis:\"\n    ls -la\n    exit 1\nfi\n\n# Configurar permiss√µes\necho \"üîß Configurando permiss√µes...\"\nchmod +x TerrariaServer.bin.x86_64\nchmod +x TerrariaServer 2>/dev/null || true\n\necho \"‚úÖ Execut√°vel configurado:\"\nls -la TerrariaServer.bin.x86_64\n\n# Limpeza\necho \"üßπ Limpando arquivos tempor√°rios...\"\nrm -rf \"$EXTRACTED_DIR\" terraria-server.zip\n\n# Criar configura√ß√£o do servidor\necho \"‚öôÔ∏è Criando configura√ß√£o do servidor...\"\ncat > serverconfig.txt << EOF\nworldpath=/home/container/saves/Worlds\nworldname=${WORLD_NAME}\nworld=/home/container/saves/Worlds/${WORLD_NAME}.wld\ndifficulty=${WORLD_DIFFICULTY}\nautocreate=${WORLD_SIZE}\nport=${SERVER_PORT}\nmaxplayers=${MAX_PLAYERS}\nmotd=${SERVER_MOTD}\nseed=${WORLD_SEED}\npassword=${PASSWORD}\nEOF\n\necho \"üìÅ Criando estrutura de diret√≥rios...\"\nmkdir -p saves/Worlds\nchown -R 1000:1000 saves/ 2>/dev/null || true\n\necho \"üìã Configura√ß√£o criada:\"\ncat serverconfig.txt\n\n# Verifica√ß√£o final\necho \"\\nüîç Verifica√ß√£o final:\"\necho \"üìÅ Arquivos no diret√≥rio:\"\nls -la\n\necho \"üîß Testando execut√°vel:\"\nif ./TerrariaServer.bin.x86_64 --help 2>/dev/null || true; then\n    echo \"‚úÖ Execut√°vel funcional\"\nelse\n    echo \"‚ö†Ô∏è Execut√°vel pode precisar de bibliotecas adicionais\"\n    echo \"üìã Verificando depend√™ncias:\"\n    ldd TerrariaServer.bin.x86_64 2>/dev/null || echo \"Comando ldd n√£o dispon√≠vel\"\nfi\n\necho \"\\nüéâ Instala√ß√£o do Terraria conclu√≠da com sucesso!\"\necho \"üéÆ Servidor pronto para iniciar na porta ${SERVER_PORT}\"\necho \"üë• M√°ximo de jogadores: ${MAX_PLAYERS}\"\necho \"üåç Mundo: ${WORLD_NAME} (Tamanho: ${WORLD_SIZE}, Dificuldade: ${WORLD_DIFFICULTY})\"\necho \"üìç Localiza√ß√£o do mundo: /home/container/saves/Worlds/\"",
      "container": "ghcr.io/pterodactyl/installers:debian",
      "entrypoint": "bash"
    }
  },
  "variables": [
    {
      "name": "Terraria Version",
      "description": "The version of Terraria server to install. Use 'latest' for the newest version",
      "env_variable": "TERRARIA_VERSION",
      "default_value": "latest",
      "user_viewable": true,
      "user_editable": true,
      "rules": "required|string|max:20",
      "field_type": "text"
    },
    {
      "name": "Server Port",
      "description": "The port to bind the server to.",
      "env_variable": "SERVER_PORT",
      "default_value": "7777",
      "user_viewable": true,
      "user_editable": false,
      "rules": "required|numeric|min:1024|max:65535",
      "field_type": "text"
    },
    {
      "name": "World Name",
      "description": "The name for the world file.",
      "env_variable": "WORLD_NAME",
      "default_value": "PyroWorld",
      "user_viewable": true,
      "user_editable": true,
      "rules": "required|string|max:20",
      "field_type": "text"
    },
    {
      "name": "Max Players",
      "description": "The maximum number of players the server will hold.",
      "env_variable": "MAX_PLAYERS",
      "default_value": "8",
      "user_viewable": true,
      "user_editable": true,
      "rules": "required|numeric|min:1|max:255",
      "field_type": "text"
    },
    {
      "name": "World Size",
      "description": "Defines the world size. 1 = Small, 2 = Medium, 3 = Large",
      "env_variable": "WORLD_SIZE",
      "default_value": "2",
      "user_viewable": true,
      "user_editable": true,
      "rules": "required|numeric|in:1,2,3",
      "field_type": "text"
    },
    {
      "name": "World Difficulty",
      "description": "World Difficulty. 0 = Classic, 1 = Expert, 2 = Master, 3 = Journey",
      "env_variable": "WORLD_DIFFICULTY",
      "default_value": "0",
      "user_viewable": true,
      "user_editable": true,
      "rules": "required|numeric|in:0,1,2,3",
      "field_type": "text"
    },
    {
      "name": "Server MOTD",
      "description": "Message of the Day displayed to players",
      "env_variable": "SERVER_MOTD",
      "default_value": "Welcome to Pyro Terraria Server!",
      "user_viewable": true,
      "user_editable": true,
      "rules": "required|string|max:128",
      "field_type": "text"
    },
    {
      "name": "World Seed",
      "description": "The seed to use when creating the world. Leave empty for random.",
      "env_variable": "WORLD_SEED",
      "default_value": "",
      "user_viewable": true,
      "user_editable": true,
      "rules": "nullable|string|max:20",
      "field_type": "text"
    },
    {
      "name": "Server Password",
      "description": "Password required to join the server. Leave empty for no password.",
      "env_variable": "PASSWORD",
      "default_value": "",
      "user_viewable": true,
      "user_editable": true,
      "rules": "nullable|string|max:20",
      "field_type": "text"
    }
  ]
}